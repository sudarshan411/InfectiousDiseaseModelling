<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Simulating COVID-19 Outbreak Using a Simple SIR Model</title>

  <meta property="description" itemprop="description" content="An exploration of COVID-19 incidence data using R tools and packages."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-02-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-02-25"/>
  <meta name="article:author" content="K Sujith Bhatt"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Simulating COVID-19 Outbreak Using a Simple SIR Model"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="An exploration of COVID-19 incidence data using R tools and packages."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Simulating COVID-19 Outbreak Using a Simple SIR Model"/>
  <meta property="twitter:description" content="An exploration of COVID-19 incidence data using R tools and packages."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","categories","author","date","output","repository url"]}},"value":[{"type":"character","attributes":{},"value":["Simulating COVID-19 Outbreak Using a Simple SIR Model"]},{"type":"character","attributes":{},"value":["An exploration of COVID-19 incidence data using R tools and packages."]},{"type":"character","attributes":{},"value":["R","COVID-19"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["K Sujith Bhatt"]},{"type":"character","attributes":{},"value":["ACM, National Institute of Technology Karnataka, Surathkal."]},{"type":"character","attributes":{},"value":["https:/nitk.acm.org"]}]}]},{"type":"character","attributes":{},"value":["2021-02-25"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["https://github.com/sujith-bhatt/InfectiousDiseaseModelling"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["assets/Li_et_al_fig3.png","assets/provinces_confirmed_jh.rda","assets/SIR.png","Base_Model_files/anchor-4.2.2/anchor.min.js","Base_Model_files/bowser-1.9.3/bowser.min.js","Base_Model_files/distill-2.2.21/template.v2.js","Base_Model_files/figure-html5/all_provinces_cum_incidence-1.png","Base_Model_files/figure-html5/all_provinces_incidence-1.png","Base_Model_files/figure-html5/Cori_empirical_si_model_fit_hubei_daily-1.png","Base_Model_files/figure-html5/Cori_model_get_data_not_hubei-1.png","Base_Model_files/figure-html5/Cori_model_get_data_wuhan-1.png","Base_Model_files/figure-html5/Cori_parametric_si_model_fit_hubei-1.png","Base_Model_files/figure-html5/Cori_parametric_si_model_fit2_hubei-1.png","Base_Model_files/figure-html5/Cori_uncertain_si_model_fit_hubei-1.png","Base_Model_files/figure-html5/Cori_uncertain_si_model_fit_hubei_daily-1.png","Base_Model_files/figure-html5/cumulative_deaths-1.png","Base_Model_files/figure-html5/cumulative_incidence-1.png","Base_Model_files/figure-html5/daily_case_deaths_plot-1.png","Base_Model_files/figure-html5/daily_deaths_plot-1.png","Base_Model_files/figure-html5/daily_incidence-1.png","Base_Model_files/figure-html5/est_R0_decay-1.png","Base_Model_files/figure-html5/est_R0_growth-1.png","Base_Model_files/figure-html5/fit_incidence_object-1.png","Base_Model_files/figure-html5/hubei_daily_incidence_adj-1.png","Base_Model_files/figure-html5/JHU_incidence-1.png","Base_Model_files/figure-html5/log_cumulative_incidence-1.png","Base_Model_files/figure-html5/plot_incidence_object-1.png","Base_Model_files/figure-html5/SIR_model_plot_extrapolated-1.png","Base_Model_files/figure-html5/SIR_model_plot_fitted_data-1.png","Base_Model_files/figure-html5/SIR_model_plot_no_intervention-1.png","Base_Model_files/figure-html5/SIR_model_plot_no_intervention_ascertainment_adjustment-1.png","Base_Model_files/figure-html5/SIR_model_plot_no_intervention_log-1.png","Base_Model_files/figure-html5/test_projection_Hubei_decay-1.png","Base_Model_files/figure-html5/test_projection_Hubei_growth-1.png","Base_Model_files/header-attrs-2.7/header-attrs.js","Base_Model_files/jquery-1.11.3/jquery.min.js","Base_Model_files/popper-2.6.0/popper.min.js","Base_Model_files/tippy-6.2.7/tippy-bundle.umd.min.js","Base_Model_files/tippy-6.2.7/tippy-light-border.css","Base_Model_files/tippy-6.2.7/tippy.css","Base_Model_files/tippy-6.2.7/tippy.umd.min.js","Base_Model_files/webcomponents-2.0.0/webcomponents.js","local.html"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="Base_Model_files/header-attrs-2.7/header-attrs.js"></script>
  <script src="Base_Model_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="Base_Model_files/popper-2.6.0/popper.min.js"></script>
  <link href="Base_Model_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="Base_Model_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="Base_Model_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="Base_Model_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="Base_Model_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="Base_Model_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="Base_Model_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Simulating COVID-19 Outbreak Using a Simple SIR Model","description":"An exploration of COVID-19 incidence data using R tools and packages.","authors":[{"author":"K Sujith Bhatt","authorURL":"#","affiliation":"ACM, National Institute of Technology Karnataka, Surathkal.","affiliationURL":"https:/nitk.acm.org","orcidID":""}],"publishedDate":"2021-02-25T00:00:00.000+05:30","citationText":"Bhatt, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Simulating COVID-19 Outbreak Using a Simple SIR Model</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">R</div>
<div class="dt=tag">COVID-19</div>
</div>
<!--/radix_placeholder_categories-->
<p>An exploration of COVID-19 incidence data using R tools and packages.</p>
</div>

<div class="d-byline">
  K Sujith Bhatt  (ACM, National Institute of Technology Karnataka, Surathkal.)<a href="https:/nitk.acm.org" class="uri">https:/nitk.acm.org</a>
  
<br/>2021-02-25
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#pre-amble">Pre-amble</a></li>
<li><a href="#modelling-the-covid-19-epidemic-in-china">Modelling the COVID-19 epidemic in China</a>
<ul>
<li><a href="#obtaining-data">Obtaining data</a></li>
<li><a href="#checking-the-data">Checking the data</a></li>
<li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
</ul></li>
<li><a href="#fitting-an-sir-model-to-the-hubei-province-data">Fitting an SIR model to the Hubei province data</a>
<ul>
<li><a href="#using-the-sir-model-for-hubei-province-to-make-predictions">Using the SIR model for Hubei province to make predictions</a></li>
<li><a href="#using-our-model-to-let-the-outbreak-run-its-course-without-intervention">Using our model to let the outbreak “run its course” without intervention</a></li>
<li><a href="#ascertainment-rates">Ascertainment rates</a></li>
</ul></li>
<li><a href="#modelling-the-epidemic-trajectory-using-log-linear-models">Modelling the epidemic trajectory using log-linear models</a>
<ul>
<li><a href="#estimating-the-reproduction-number-from-log-linear-models">Estimating the reproduction number from log-linear models</a></li>
</ul></li>
<li><a href="#projections">Projections</a></li>
<li><a href="#conclusions">Conclusions</a>
<ul>
<li><a href="#public-health-considerations">Public health considerations</a></li>
<li><a href="#data-science-considerations">Data science considerations</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="pre-amble">Pre-amble</h1>
<p>This paper is the first of the few experiments done to simulate the COVID-19 outbreak as part of the co-curricular project undertaking for the Association for Computing Machinery, NITK Chapter.</p>
<p>Please note that this paper has not been peer-reviewed, and that I claim no particular expertise in modeling communicable disease outbreaks.</p>
<p>Please also note that this paper <strong>only uses data for Chinese cases up to 15th February 2020</strong>, and thus it cannot be considered a <strong>situation report</strong> reflecting the latest available data. The reason for truncating data at 15th February is due to the major changes in the case definitions used by the authorities in Hubei province from that date forward, which add additional complications to the modeling presented here.</p>
<p>The full code is available from the GitHub repository: <a href="https://github.com/sujith-bhatt/InfectiousDiseaseModelling" class="uri">https://github.com/sujith-bhatt/InfectiousDiseaseModelling</a>.</p>
<h1 id="modelling-the-covid-19-epidemic-in-china">Modelling the COVID-19 epidemic in China</h1>
<p>Given that Wuhan and other cities in Hubei province have effectively been partitioned from the rest of China since about 24th January, it makes sense to model the situation in Hubei only, so we’ll do the model fitting process for that. But first we need some data, and of course we need to do an initial exploratory data analysis before we fit any models!</p>
<h2 id="obtaining-data">Obtaining data</h2>
<p>Naturally we want our analysis to be reproducible, and that means avoiding all manual abstracting and transcribing of data. Thus we will programmatically acquire the relevant data from the web – we want to be able to just re-run the program code and have analyses automatically update themselves. There are now many potential sources, one of which is <a href="https://en.wikipedia.org/wiki/Timeline_of_the_2019–20_Wuhan_coronavirus_outbreak">this wikipedia page</a>, which is currently being updated very promptly as new data is released. It is a detailed and well-referenced source, and, being wikipedia, it is also versioned.</p>
<p>Lets download and scrape the data contained in the relevant tables on that page that give counts of laboratory-confirmed cases, and deaths in confirmed cases, by day and by province, clean it up and have it ready to use in our analysis. Note that counts of clinically-confirmed cases (by lung CT) that were being reported by Hubei province for a while are not used in this analysis, so we will remove them from the data we acquire.</p>
<p>Here is the code used to acquire data from wikipedia. Notice that the code references a specific version of the relevant wikipedia page.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># download the wikipedia web page</span>
<span class='co'># we use a specific version of the template page directly</span>
<span class='co'># version of the wikipedia page that is used by this version of this document</span>
<span class='co'># we download the specific version into the local system and make further mutations on the local file instead</span>

<span class='va'>url</span> <span class='op'>=</span> <span class='st'>"https://en.wikipedia.org/w/index.php?title=Template:2019%E2%80%9320_Wuhan_coronavirus_data/China_medical_cases_by_province&amp;oldid=941235662"</span>
<span class='fu'><a href='https://rdrr.io/r/utils/download.file.html'>download.file</a></span><span class='op'>(</span><span class='va'>url</span>,destfile <span class='op'>=</span> <span class='st'>"local.html"</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>outbreak_webpage</span> <span class='op'>&lt;-</span> <span class='fu'>read_html</span><span class='op'>(</span><span class='st'>"local.html"</span><span class='op'>)</span>

<span class='co'># parse the web page and extract the data from the first table </span>
<span class='va'>provinces_confirmed</span> <span class='op'>&lt;-</span> <span class='va'>outbreak_webpage</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_nodes.html'>html_nodes</a></span><span class='op'>(</span><span class='st'>"table"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='va'>.</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_table.html'>html_table</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>rename</span><span class='op'>(</span>Date<span class='op'>=</span><span class='st'>"Date (CST)"</span><span class='op'>)</span>

<span class='co'># fix up the column names, get rid of footnotes and other non-data</span>
<span class='co'># and convert columns to appropriate data types.</span>
<span class='va'>excl_hubei</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"ExcludingHubei"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pull</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>hubei_sans_wuhan</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span> 
                        <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"Hubei:"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"clinical"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                        <span class='fu'>pull</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='co'># utility function to remove commas in numbers as character strings</span>
<span class='va'>rm_commas</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>","</span>, <span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span>

<span class='va'>provinces_confirmed</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"ExcludingHubei"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"Hubei:"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>rename</span><span class='op'>(</span>Wuhan<span class='op'>=</span><span class='st'>"Wuhan,Hubei"</span>,
                               National<span class='op'>=</span><span class='st'>"National(confirmed)"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate</span><span class='op'>(</span>NationalSansHubei<span class='op'>=</span><span class='va'>excl_hubei</span>,
                               HubeiSansWuhan<span class='op'>=</span><span class='va'>hubei_sans_wuhan</span>,
                               Date<span class='op'>=</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span>,
                               National<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>National</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                               Hubei<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>Hubei</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                               Wuhan<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>Wuhan</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>
                               <span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"clinical"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"inclusive"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate_if</span><span class='op'>(</span><span class='va'>is.character</span>, <span class='va'>rm_commas</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate_if</span><span class='op'>(</span><span class='va'>is.character</span>, <span class='va'>as.integer</span><span class='op'>)</span> 

<span class='co'># work out the order for the columns from the data, descending order</span>
<span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>Date</span>, names_to<span class='op'>=</span><span class='st'>"province"</span>,
                 values_to<span class='op'>=</span><span class='st'>"incident_cases"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>summarise</span><span class='op'>(</span>total<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>incident_cases</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>total</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>pull</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>province_order</span>

<span class='co'># re-arrange the columns in the dataset and fill in some </span>
<span class='co'># missing values, but not all, with zeroes.</span>
<span class='co'># Also, lab-confirmed and clinical counts for Wuhan are combined on the</span>
<span class='co'># source Hubei health Commission from 15 Feb so</span>
<span class='co'># set to NA since we cannot split out the lab-confirmed only</span>
<span class='va'>provinces_confirmed</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>,<span class='va'>province_order</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>National<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>National</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>National</span><span class='op'>)</span>,
           Hubei<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Hubei</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>Hubei</span><span class='op'>)</span>,
           Wuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Wuhan</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>Wuhan</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>Wuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-15"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>Wuhan</span><span class='op'>)</span>,
           HubeiSansWuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-15"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>HubeiSansWuhan</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># repeat for deaths</span>
<span class='co'># parse the web page and extract the data from the second table </span>
<span class='va'>provinces_deaths</span> <span class='op'>&lt;-</span> <span class='va'>outbreak_webpage</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_nodes.html'>html_nodes</a></span><span class='op'>(</span><span class='st'>"table"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='va'>.</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_table.html'>html_table</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>rename</span><span class='op'>(</span>Date<span class='op'>=</span><span class='st'>"Date (CST)"</span><span class='op'>)</span>

<span class='co'># fix up the column names, get rid of footnotes and other non-data</span>
<span class='co'># and convert columns to appropriate data types.</span>
<span class='va'>hubei_sans_wuhan</span> <span class='op'>&lt;-</span> <span class='va'>provinces_deaths</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"Hubei:"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                      <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"clinical"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
                      <span class='fu'>pull</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>

<span class='va'>provinces_deaths</span> <span class='op'>&lt;-</span> <span class='va'>provinces_deaths</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"Hubei:"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>rename</span><span class='op'>(</span>Wuhan<span class='op'>=</span><span class='st'>"Wuhan,Hubei"</span>,
                               National<span class='op'>=</span><span class='st'>"National(confirmed)"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate</span><span class='op'>(</span>
                               HubeiSansWuhan<span class='op'>=</span><span class='va'>hubei_sans_wuhan</span>,
                               Date<span class='op'>=</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span>,
                               National<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>National</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                               Hubei<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>Hubei</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
                               Wuhan<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_split.html'>str_split</a></span><span class='op'>(</span><span class='va'>Wuhan</span>, <span class='st'>"\\["</span>, simplify<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>
                               <span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"clinical"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"inclusive"</span>, ignore.case <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate_if</span><span class='op'>(</span><span class='va'>is.character</span>, <span class='va'>rm_commas</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate_if</span><span class='op'>(</span><span class='va'>is.character</span>, <span class='va'>as.integer</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                        <span class='fu'>mutate</span><span class='op'>(</span>NationalSansHubei <span class='op'>=</span> <span class='va'>National</span> <span class='op'>-</span> <span class='va'>Hubei</span><span class='op'>)</span>


<span class='co'># work out the order for the columns from the data, descending order</span>
<span class='va'>provinces_deaths</span> <span class='op'>%&gt;%</span> 
    <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>Date</span>, names_to<span class='op'>=</span><span class='st'>"province"</span>,
                 values_to<span class='op'>=</span><span class='st'>"deaths_in_confirmed_cases"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>summarise</span><span class='op'>(</span>total<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>deaths_in_confirmed_cases</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>total</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>pull</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>province_order_deaths</span>

<span class='co'># re-arrange the columns in the dataset and fill in some </span>
<span class='co'># missing values, but not all, with zeroes</span>
<span class='co'># Also, lab-confirmed and clinical deaths for Wuhan are combined on the</span>
<span class='co'># source Hubei health Commission from 15 Feb so</span>
<span class='co'># set to NA since we cannot split out the deaths in lab-confirmed cases only</span>
<span class='va'>provinces_deaths</span> <span class='op'>&lt;-</span> <span class='va'>provinces_deaths</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Date'</span>,<span class='va'>province_order_deaths</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>National<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>National</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>National</span><span class='op'>)</span>,
           Hubei<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Hubei</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>Hubei</span><span class='op'>)</span>,
           Wuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Wuhan</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>Wuhan</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>Wuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-15"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>Wuhan</span><span class='op'>)</span>,
           HubeiSansWuhan<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-15"</span><span class='op'>)</span>, <span class='cn'>NA</span>, <span class='va'>HubeiSansWuhan</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># there are still issues with death counts in lab-confirmed after 12th Feb.</span>
<span class='co'># in particular the national count is less than that of Hubei count.</span>
<span class='co'># So we will just truncate the deaths at 12th Feb.</span>
<span class='va'>provinces_deaths</span> <span class='op'>&lt;-</span> <span class='va'>provinces_deaths</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-12"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In the next section, we will compare the wikipedia source to a widely-used source provided by Johns Hopkins University in the US. In the interests of brevity, we won’t display the scraped incidence and deaths data in a table here, but doing so would be good practice.</p>
<h2 id="checking-the-data">Checking the data</h2>
<p>Wikipedia is <em>crowd-sourced</em>, and anyone can edit the pages at any time, although incorrect information is usually corrected very rapidly by a community of editors and contributors, at least for active pages of interest. That is certainly the case for the wikipedia pages on COVID-19 incidence and deaths data we are using in this analysis. Nonetheless, it is <strong>always</strong> a good idea to check sources wherever possible.</p>
<p>In fact, there is <a href="https://github.com/CSSEGISandData/COVID-19">another source of similar, collated COVID-19 data</a>, maintained by Johns Hopkins University Center for Systems Science and Engineering (JHU CCSE) and used as the source for <a href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6">the dashboard</a> which they provide.</p>
<p>So let’s download that data and compare it to the data we are scraping from wikipedia. We are using a cached copy of <a href="https://github.com/CSSEGISandData/COVID-19/blob/5a0760fcfee8f698cff0251b6e578385153f396e/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv">this revision</a> of the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>destfile</span><span class='op'>=</span><span class='st'>"./assets/provinces_confirmed_jh.rda"</span> 
<span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='va'>destfile</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>provinces_confirmed_jh</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>rename</span><span class='op'>(</span>province<span class='op'>=</span><span class='st'>"Province/State"</span>,
           country_region<span class='op'>=</span><span class='st'>"Country/Region"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>province</span>, <span class='va'>country_region</span>, <span class='va'>Lat</span>, <span class='va'>Long</span><span class='op'>)</span>, 
                 names_to <span class='op'>=</span> <span class='st'>"Date"</span>,
                 values_to<span class='op'>=</span><span class='st'>"cumulative_cases"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>Date<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>mdy_hm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>Date</span>, <span class='st'>"23:59"</span>, tz<span class='op'>=</span><span class='st'>"UTC"</span><span class='op'>)</span><span class='op'>)</span>, tz<span class='op'>=</span><span class='st'>"China/Beijing"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>country_region</span> <span class='op'>==</span> <span class='st'>"Mainland China"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>province</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>province</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>incident_cases <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fu'><a href='https://rdrr.io/r/base/diff.html'>diff</a></span><span class='op'>(</span><span class='va'>cumulative_cases</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>country_region</span>, <span class='va'>Lat</span>, <span class='va'>Long</span>, <span class='va'>cumulative_cases</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>pivot_wider</span><span class='op'>(</span><span class='va'>Date</span>, names_from <span class='op'>=</span> <span class='va'>province</span>,
                values_from<span class='op'>=</span><span class='va'>incident_cases</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>rename</span><span class='op'>(</span>InnerMongolia<span class='op'>=</span><span class='st'>"Inner Mongolia"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>source<span class='op'>=</span><span class='st'>"Johns Hopkins University"</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/save.html'>save</a></span><span class='op'>(</span><span class='va'>provinces_confirmed_jh</span>, file<span class='op'>=</span><span class='va'>destfile</span><span class='op'>)</span>
<span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='va'>destfile</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>compare_provinces_confirmed</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span>
                                <span class='fu'>mutate</span><span class='op'>(</span>source<span class='op'>=</span><span class='st'>"wikipedia"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>source</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>provinces_confirmed_jh</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>provinces_confirmed_jh</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>Date</span>, <span class='fu'>desc</span><span class='op'>(</span><span class='va'>source</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                                <span class='fu'>select</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>source</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>compare_provinces_confirmed</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-12"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>source</span><span class='op'>)</span>, 
               names_to<span class='op'>=</span><span class='st'>"province"</span>,
               values_to<span class='op'>=</span><span class='st'>"incident_cases"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>province</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Hubei"</span>,  <span class='st'>"Beijing"</span>, <span class='st'>"Guangdong"</span>,
                         <span class='st'>"Henan"</span>,  <span class='st'>"Zhejiang"</span>,  <span class='st'>"Hunan"</span>,  <span class='st'>"Anhui"</span>,
                         <span class='st'>"Jiangxi"</span>,  <span class='st'>"Jiangsu"</span>,  <span class='st'>"Chongqing"</span>,  
                         <span class='st'>"Shandong"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>compare_provinces_confirmed_long</span>

<span class='va'>compare_provinces_confirmed_long</span> <span class='op'>%&gt;%</span>
  <span class='fu'>bind_rows</span><span class='op'>(</span><span class='va'>compare_provinces_confirmed_long</span> <span class='op'>%&gt;%</span>
              <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>source</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>summarise</span><span class='op'>(</span>incident_cases <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>incident_cases</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>mutate</span><span class='op'>(</span>province <span class='op'>=</span> <span class='st'>"Sum all provinces"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Date</span>, y<span class='op'>=</span><span class='va'>incident_cases</span>, colour<span class='op'>=</span><span class='va'>source</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span><span class='va'>province</span><span class='op'>~</span><span class='va'>.</span>, scale<span class='op'>=</span><span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"Daily incident confirmed cases"</span>,
         title<span class='op'>=</span><span class='st'>"Comparison of wikipedia and Johns Hopkins University\nCOVID-19 daily incidence data up to 12th February, 2020."</span>,
         subtitle<span class='op'>=</span><span class='st'>"(Note: not all provinces shown here)"</span>,
         caption<span class='op'>=</span><span class='st'>"Sources: Johns Hopkins CSSE Novel coronavirus COVID-19 (2019-nCoV) data repository\nat https://github.com/CSSEGISandData/COVID-19\nwikipedia: https://en.wikipedia.org/wiki/Timeline_of_the_2019–20_Wuhan_coronavirus_outbreak"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>"top"</span>, legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/JHU_incidence-1.png" width="624" /></p>
</div>
<p>There is clearly a lag of 1 day between the two sources for many, but not all of the provinces. That isn’t a major concern and won’t change any of our analyses very much. Of much greater concern are the large differences for specific days, for the provinces with substantial numbers of cases. The most egregious difference between the JHU and wikipedia incidence data is for Hubei province on 2nd February 2020, for which the JHU data gives 4024 new cases, and the wikipedia data gives 2103 new cases. Note that that was well before the change in case definition for Hubei province, which occured on 12th February. Further research showed that the wikipedia data are, in fact, correct.</p>
<h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>Every analysis should start with a thorough EDA. The code for all this is just standard <code>tidyverse</code> fair.</p>
<h3 id="daily-cumulative-incidence">Daily cumulative incidence</h3>
<p>First, let’s look at the daily cumulative number of incident, lab-confirmed cases for Wuhan city, for Hubei province (which contains Wuhan), for all the other provinces combined, and for all of China.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/cumulative_incidence-1.png" width="960" /></p>
</div>
<p>The initial increases for Wuhan and the balance of Hubei, and for all of China look to be approximately exponential, as is expected for epidemic spread. Let’s plot them on a logarithmic <em>y</em> axis. We would expect to see a linear increase on a log scale if the epidemic curve is indeed exponential.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/log_cumulative_incidence-1.png" width="960" /></p>
</div>
<p>One could convince oneself that log-linearity is present.</p>
<h3 id="daily-incremental-incidence">Daily incremental incidence</h3>
<p>Let’s also look at the daily incremental incidence. This is more informative, and is known in outbreak epidemiological parlance as the <em>epidemic curve</em>. It is traditionally visualised as a bar chart, which emphasises missing data more than a line chart, even one with points as well. We’ll adhere to epidemiological tradition.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/daily_incidence-1.png" width="960" /></p>
</div>
<p>It looks like incidence has plateaued and is now beginning to decline in Wuhan, and that daily incremental incidence is very definitely falling everywhere else in mainland China.</p>
<h3 id="epidemic-curves-for-all-provinces-plus-wuhan-city">Epidemic curves for all provinces, plus Wuhan city</h3>
<p>Finally, let’s quickly visualise the epidemic curves for all the provinces (plus Wuhan city).</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/all_provinces_incidence-1.png" width="960" /></p>
</div>
<p>And let’s look at the cumulative incidence, with all provinces on the same scale to put things in perspective.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/all_provinces_cum_incidence-1.png" width="960" /></p>
</div>
<p>It is clear that Wuhan is not only the epicentre of the outbreak, but that it continues to be the main location of new infections.</p>
<h3 id="daily-cumulative-and-incremental-deaths-in-lab-confirmed-cases">Daily cumulative and incremental deaths in lab-confirmed cases</h3>
<p>Now let’s look the daily (incremental) number of deaths in lab-confirmed cases for Wuhan city, for Hubei province (which contains Wuhan), for all the other provinces combined, and for all of China.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/cumulative_deaths-1.png" width="960" /></p>
</div>
<p>Let’s also look at the daily incremental deaths in lab-confirmed cases.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/daily_deaths_plot-1.png" width="960" /></p>
</div>
<h3 id="incidence-and-deaths">Incidence and deaths</h3>
<p>Finally, let’s also look at the number of daily incremental lab-confirmed incident cases and the daily incremental deaths in lab-confirmed cases, aligned by date.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/daily_case_deaths_plot-1.png" width="960" /></p>
</div>
<p>Clearly daily counts of deaths are continuing to rise despite the fact that the daily count of new cases is now falling. This is not surprising, given that it takes some time for cases to either recover or to die, and therefore the trend in deaths will necessarily lag behind any trend in daily incidence.</p>
<h1 id="fitting-an-sir-model-to-the-hubei-province-data">Fitting an SIR model to the Hubei province data</h1>
<p>The basic idea behind the SIR model of communicable disease outbreaks is that there are three groups (also called <em>compartments</em>) of people: those who are healthy but susceptible to the disease <span class="math inline">\(S\)</span>, the infectious (and thus, infected) <span class="math inline">\(I\)</span> and people who have recovered <span class="math inline">\(R\)</span>:</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/8/8a/SIR.PNG" alt="Source: wikipedia" /><figcaption aria-hidden="true">Source: wikipedia</figcaption>
</figure>
<p>To model the dynamics of the outbreak we need three differential equations, to describe the rates of change in each group, parameterised by <span class="math inline">\(\beta\)</span> which controls the transition between <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span> and <span class="math inline">\(\gamma\)</span> which controls the transition between <span class="math inline">\(I\)</span> and <span class="math inline">\(R\)</span>:</p>
<p><span class="math display">\[\frac{dS}{dt} = - \frac{\beta I S}{N}\]</span></p>
<p><span class="math display">\[\frac{dI}{dt} = \frac{\beta I S}{N}- \gamma I\]</span></p>
<p><span class="math display">\[\frac{dR}{dt} = \gamma I\]</span></p>
<p>The first step is to express these differential equations as an <em>R</em> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>SIR</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>time</span>, <span class='va'>state</span>, <span class='va'>parameters</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>par</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>state</span>, <span class='va'>parameters</span><span class='op'>)</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>par</span>, <span class='op'>{</span>
    <span class='va'>dS</span> <span class='op'>&lt;-</span> <span class='op'>-</span><span class='va'>beta</span> <span class='op'>*</span> <span class='va'>I</span> <span class='op'>*</span> <span class='va'>S</span> <span class='op'>/</span> <span class='va'>N</span>
    <span class='va'>dI</span> <span class='op'>&lt;-</span> <span class='va'>beta</span> <span class='op'>*</span> <span class='va'>I</span> <span class='op'>*</span> <span class='va'>S</span> <span class='op'>/</span> <span class='va'>N</span> <span class='op'>-</span> <span class='va'>gamma</span> <span class='op'>*</span> <span class='va'>I</span>
    <span class='va'>dR</span> <span class='op'>&lt;-</span> <span class='va'>gamma</span> <span class='op'>*</span> <span class='va'>I</span>
    <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>dS</span>, <span class='va'>dI</span>, <span class='va'>dR</span><span class='op'>)</span><span class='op'>)</span>
    <span class='op'>}</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>To fit the model to the data we need two things: a solver for these differential equations and an optimiser to find the optimal values for our two unknown parameters, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>. The function <code>ode()</code> (for <em>ordinary differential equations</em>) from the <code>deSolve</code> package for <code>R</code> makes solving the system of equations easy, and to find the optimal values for the parameters we wish to estimate, we can just use the <code>optim</code> function built into base <em>R</em>. Specifically what we need to do is minimise the sum of the squared differences between <span class="math inline">\(I(t)\)</span>, which is the number of people in the infectious compartment <span class="math inline">\(I\)</span> at time <span class="math inline">\(t\)</span>, and the corresponding number of cases as predicted by our model <span class="math inline">\(\hat{I}(t)\)</span>. This quantity is known as the <em>residual sum of squares</em> (RSS)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p><span class="math display">\[RSS(\beta, \gamma) = \sum_{t} \left( I(t)-\hat{I}(t) \right)^2\]</span></p>
<p>Rather than fit a model to the incidence data for all of China, let’s fit a model to the incidence data for Hubei province only, given that Hubei contains Wuhan, the city which is the source of the outbreak. Most cities in Hubei have been isolated from the rest of China since 23rd January, so it makes sense to model Hubei separately. We need a value <span class="math inline">\(N\)</span> for the initial uninfected population. Once again we’ll scrape population data from a suitable wikipedia page</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>The approximate population of Hubei province in 2017 was 59,020,000 people, according to <a href="https://en.wikipedia.org/wiki/List_of_Chinese_administrative_divisions_by_population">this wikipedia page</a>.</p>
<p>Next, we need to create a vector with the daily cumulative incidence for Hubei, from 15th January when our daily incidence data starts, through to 30th January. We’ll then compare the predicted incidence from the SIR model fitted to these data with the actual incidence since 30th January. We also need to initialise the values for <span class="math inline">\(S\)</span>, <span class="math inline">\(I\)</span> and <span class="math inline">\(R\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># put the daily cumulative incidence numbers for Hubei from </span>
<span class='co'># 15th Jan to 30th Jan into a vector called Infected</span>
<span class='va'>sir_start_date</span> <span class='op'>&lt;-</span> <span class='st'>"2020-01-15"</span>

<span class='va'>Infected</span> <span class='op'>&lt;-</span> <span class='va'>cumulative_incidence</span> <span class='op'>%&gt;%</span>
              <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>province</span> <span class='op'>==</span> <span class='st'>"Hubei"</span>,
                     <span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-01-15"</span><span class='op'>)</span>,
                     <span class='va'>Date</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-01-30"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
              <span class='fu'>pull</span><span class='op'>(</span><span class='va'>cumulative_incident_cases</span><span class='op'>)</span>

<span class='co'># Create an incrementing Day vector the same length as our cases vector</span>
<span class='va'>Day</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>Infected</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># now specify initial values for S, I and R</span>
<span class='va'>init</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>S <span class='op'>=</span> <span class='va'>N</span><span class='op'>-</span><span class='va'>Infected</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, I <span class='op'>=</span> <span class='va'>Infected</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, R <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Then we need to define a function to calculate the <span class="math inline">\(RSS\)</span>, given a set of values for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># define a function to calculate the residual sum of squares (RSS),</span>
<span class='co'># passing in parameters beta and gamma that are to be optimised for the</span>
<span class='co'># best fit to the incidence data</span>
<span class='va'>RSS</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>parameters</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>parameters</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"beta"</span>, <span class='st'>"gamma"</span><span class='op'>)</span>
  <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>init</span>, times <span class='op'>=</span> <span class='va'>Day</span>, func <span class='op'>=</span> <span class='va'>SIR</span>, parms <span class='op'>=</span> <span class='va'>parameters</span><span class='op'>)</span>
  <span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='va'>out</span><span class='op'>[</span> , <span class='fl'>3</span><span class='op'>]</span>
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>Infected</span> <span class='op'>-</span> <span class='va'>fit</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Finally, we can fit the SIR model to our data by finding the values for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> that minimise the residual sum of squares between the observed cumulative incidence and the predicted cumulative incidence. We also need to check that our model has converged, as indicated by the message shown below:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># now find the values of beta and gamma that give the smallest RSS,</span>
<span class='co'># which represents the best fit to the data. Start with values of 0.5 for each,</span>
<span class='co'># and constrain them to the interval 0 to 1.0</span>
<span class='va'>Opt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/optim.html'>optim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>, <span class='va'>RSS</span>, 
             method <span class='op'>=</span> <span class='st'>"L-BFGS-B"</span>, 
             lower <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span>, upper <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> 

<span class='co'># check for convergence</span>
<span class='va'>Opt</span><span class='op'>$</span><span class='va'>message</span>
</code></pre>
</div>
<pre><code>[1] &quot;CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH&quot;</code></pre>
</div>
<p>Convergence is confirmed. Now we can examine the fitted values for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Opt_par</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='va'>Opt</span><span class='op'>$</span><span class='va'>par</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"beta"</span>, <span class='st'>"gamma"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Opt_par</span>
</code></pre>
</div>
<pre><code>     beta     gamma 
0.6671291 0.3328710 </code></pre>
</div>
<p>Those values don’t mean a lot, <em>per se</em>, but let’s use them to get the fitted numbers of people in each compartment of our SIR model for the dates up to 30th January that were used to fit the model, and compare those fitted values with the observed data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># time in days for predictions</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/now.html'>today</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='va'>sir_start_date</span><span class='op'>)</span><span class='op'>)</span> 
<span class='co'># get the fitted values from our SIR model</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>init</span>, times <span class='op'>=</span> <span class='va'>t</span>, 
                                              func <span class='op'>=</span> <span class='va'>SIR</span>, parms <span class='op'>=</span> <span class='va'>Opt_par</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># add a Date column and join the observed incidence data</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>&lt;-</span> <span class='va'>fitted_cumulative_incidence</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>Date<span class='op'>=</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='va'>sir_start_date</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/period.html'>days</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,
           province<span class='op'>=</span><span class='st'>"Hubei"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>cumulative_incidence</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>province</span><span class='op'>==</span><span class='st'>"Hubei"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'>select</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>cumulative_incident_cases</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># plot the data</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&lt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-01-30"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>I</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>cumulative_incident_cases</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"orange"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"Cumulative incidence"</span>, 
                   title<span class='op'>=</span><span class='st'>"COVID-19 fitted vs observed cumulative incidence, Hubei province"</span>,
                   subtitle<span class='op'>=</span><span class='st'>"(red=fitted incidence from SIR model, orange=observed incidence)"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/SIR_model_plot_fitted_data-1.png" width="624" /></p>
</div>
<p>That looks like a reasonably good fit to the observed cumulative incidence data, so we can now use our fitted model to calculate the <em>basic reproduction number</em> <span class="math inline">\(R_{0}\)</span> which gives the average number of susceptible people who are infected by each infectious person:</p>
<p><span class="math display">\[R_{0} = \frac{\beta}{\gamma}\]</span></p>
<p>We get:</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>      R0 
2.004167 </code></pre>
</div>
<p>An <span class="math inline">\(R_{0}\)</span> of 2.0 is consistent the values calculated by others for COVID-19, and is also consistent with the <span class="math inline">\(R_{0}\)</span> for SARS and MERS, which are similar diseases also caused by <em>coronavirus</em>.</p>
<h2 id="using-the-sir-model-for-hubei-province-to-make-predictions">Using the SIR model for Hubei province to make predictions</h2>
<p>The next step is to use our fitted SIR model to make predictions about the future course of the outbreak. However, caution is required, because the SIR model assumes a fixed <em>reproduction number</em>, but if public health interventions have been implemented, such as quarantining of cases, contact tracing and isolation of those contacts, and general restrictions on social mixing, such as closing the city of Wuhan, then the <em>effective reproduction number</em> <span class="math inline">\(R_{e}\)</span> will be dynamic and should fall as those interventions are progressively implemented, to values considerably less than the <em>basic reproduction number</em> <span class="math inline">\(R_{0}\)</span>, which reflects the behaviour of the virus at the beginning of an epidemic before any response has been implemented.</p>
<p>So let’s use our SIR model, fitted to the first 15 days of data, to extrapolate out to the current date, and compare that against the observed values:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/SIR_model_plot_extrapolated-1.png" width="624" /></p>
</div>
<p>We can see that the actual incidence is much lower than that predicted by our model. The reason is that, due to the swift and decisive public health interventions implemented by the Chinese authorities, the <span class="math inline">\(R_{e}\)</span> of the COVID-19 in Hubei province has already been substantially reduced. When the <span class="math inline">\(R_{e}\)</span> falls below 1.0, the peak of the epidemic (at least in Hubei) will have been reached and the outbreak will eventually die out.</p>
<h2 id="using-our-model-to-let-the-outbreak-run-its-course-without-intervention">Using our model to let the outbreak “run its course” without intervention</h2>
<p>It is instructive to use our model fitted to the first 15 days of available data on lab-confirmed cases in Hubei province, to see what would happen if the outbreak were left to run its course, without public health interventions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># time in days for predictions</span>
<span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>70</span>
<span class='co'># get the fitted values from our SIR model</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/deSolve/man/ode.html'>ode</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>init</span>, times <span class='op'>=</span> <span class='va'>t</span>, 
                                              func <span class='op'>=</span> <span class='va'>SIR</span>, parms <span class='op'>=</span> <span class='va'>Opt_par</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># add a Date column and join the observed incidence data</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>&lt;-</span> <span class='va'>fitted_cumulative_incidence</span> <span class='op'>%&gt;%</span>
    <span class='fu'>mutate</span><span class='op'>(</span>Date<span class='op'>=</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='va'>sir_start_date</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/period.html'>days</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span>,
           province<span class='op'>=</span><span class='st'>"Hubei"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>cumulative_incidence</span> <span class='op'>%&gt;%</span> 
                <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>province</span><span class='op'>==</span><span class='st'>"Hubei"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                <span class='fu'>select</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>cumulative_incident_cases</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># plot the data</span>
<span class='va'>fitted_cumulative_incidence</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Date</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>I</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>S</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>R</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"green"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>cumulative_incident_cases</span><span class='op'>)</span>, colour<span class='op'>=</span><span class='st'>"orange"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org//reference/label_number.html'>comma</a></span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='st'>"Persons"</span>, 
                   title<span class='op'>=</span><span class='st'>"COVID-19 fitted vs observed cumulative incidence, Hubei province"</span><span class='op'>)</span> <span class='op'>+</span>
              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>''</span>, 
         values <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'red'</span><span class='op'>=</span><span class='st'>'red'</span>, <span class='st'>'black'</span><span class='op'>=</span><span class='st'>'black'</span>, <span class='st'>'green'</span><span class='op'>=</span><span class='st'>'green'</span>, <span class='st'>'orange'</span><span class='op'>=</span><span class='st'>'orange'</span><span class='op'>)</span>, 
         labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Susceptible'</span>, <span class='st'>'Recovered'</span>, <span class='st'>'Observed incidence'</span>, <span class='st'>'Infectious'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/SIR_model_plot_no_intervention-1.png" width="624" /></p>
</div>
<p>It is easier to see what is going on if we use a log scale:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/SIR_model_plot_no_intervention_log-1.png" width="624" /></p>
</div>
<p>Clearly that prediction, should it come to pass, would be an unmitigated disaster. At this point, it is worth remarking on the importance of decisive public health intervention to limit the spread of such epidemics. Without such interventions, tens of millions of people could be infected, as our model predicts, and even with only a one or two per cent mortality rate, hundreds of thousands of people would die.</p>
<h2 id="ascertainment-rates">Ascertainment rates</h2>
<p>So far, we have assumed that the counts of lab-confirmed cases represent all the cases that are infectious. This is unlikely to be true – typically only a proportion of actual cases are detected or found or sent for testing. This proportion is known as the <em>ascertainment rate</em>. The ascertainment rate is likely to change during the course of an outbreak, particularly if surveillance and screening efforts are increased, or if case definitions are changed. Such changing ascertainment rates can be easily incorporated into our model by using a set of weights, or a weighting function, for our incidence data, but for the sake of simplicity, let’s see what happens if we assume a fixed ascertainment rate of 20%. If we apply that, thus inflating the number of incident cases by a factor of 5, and refit our model, we get the following results.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>[1] &quot;CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH&quot;</code></pre>
<pre><code>     beta     gamma 
0.6671730 0.3328275 </code></pre>
<pre><code>      R0 
2.004561 </code></pre>
</div>
<p>Note that these fitted parameters are the same as the ones we got above, without an ascertainment rate adjustment. Let’s look at the fitted values.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/SIR_model_plot_no_intervention_ascertainment_adjustment-1.png" width="624" /></p>
</div>
<p>Perhaps counter-intuitively, incorporation of a fixed 20% ascertainment rate adjustment into our model makes little difference to the modelled outbreak if it is let run its course, except that it all happens a bit more quickly. But the number of infections remains the same, and the <em>basic reproduction number</em> is unchanged. Note that that is for a fixed ascertainment rate. If the ascertainment rate varies significantly over time, then the parameter estimates will necessarily be biased – but in the early days of an outbreak, it may be reasonable to assume that ascertainment rates don’t change too much.</p>
<h1 id="modelling-the-epidemic-trajectory-using-log-linear-models">Modelling the epidemic trajectory using log-linear models</h1>
<p>As noted above, the initial exponential phase of an outbreak, when shown in a semi-log plot (the y-axis with a logarithmic transform), appears (somewhat) linear. This suggests that we can model epidemic growth, and decay, using a simple log-linear model of the form:</p>
<p><span class="math display">\[log(y) = rt + b\]</span></p>
<p>where <span class="math inline">\(y\)</span> is the incidence, <span class="math inline">\(r\)</span> is the growth rate, <span class="math inline">\(t\)</span> is the number of days since a specific point in time (typically the start of the outbreak), and <span class="math inline">\(b\)</span> is the intercept. Separate models are fitted to the growth and the decay parts of the epidemic (incidence data) curve.</p>
<p>The <code>incidence</code> package for R, part of the excellent <a href="https://www.repidemicsconsortium.org"><strong>R</strong> <strong>E</strong>pidemics <strong>Con</strong>sortium (<strong>RECON</strong>) suite</a> of packages for epidemic modelling and control, makes the fitting of such models very convenient. We’ll use that package to fit such a model. We need to convert daily case counts back into one case per row format first. The <code>uncount()</code> function the the <code>tidyr</code> package is perfect for doing that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># create a vector of dates, in character form, one for each case in Hubei province on each date</span>
<span class='co'># using the uncount() function.</span>
<span class='va'>hubei_incidence_function_data</span> <span class='op'>&lt;-</span> <span class='va'>provinces_confirmed</span> <span class='op'>%&gt;%</span>
                          <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&gt;=</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-01-11"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>mutate</span><span class='op'>(</span>HubeiSansWuhan <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>HubeiSansWuhan</span><span class='op'>)</span>, <span class='fl'>0</span>, <span class='va'>HubeiSansWuhan</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>mutate</span><span class='op'>(</span>incident_cases<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>&lt;</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='st'>"2020-02-15"</span><span class='op'>)</span>, 
                                                       <span class='va'>Wuhan</span> <span class='op'>+</span> <span class='va'>HubeiSansWuhan</span>, 
                                                       <span class='va'>Hubei</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>mutate</span><span class='op'>(</span>Date<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>Date</span>, <span class='st'>"%Y-%m-%d"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>select</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>incident_cases</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
                          <span class='fu'>uncount</span><span class='op'>(</span><span class='va'>incident_cases</span><span class='op'>)</span>

<span class='va'>hubei_incidence_object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/incidence.html'>incidence</a></span><span class='op'>(</span><span class='va'>hubei_incidence_function_data</span><span class='op'>$</span><span class='va'>Date</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can then find the date of peak incidence and indicate that on a plot of the daily incidence data. The <code>find_peak()</code> function in the <code>incidence</code> library does that for us.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hubei_incidence_peak</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/find_peak.html'>find_peak</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>hubei_incidence_peak</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Daily incidence of lab-confirmed cases, Hubei province"</span>,
       subtitle <span class='op'>=</span> <span class='st'>"(red line indicates date of peak incidence)"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/plot_incidence_object-1.png" width="624" /></p>
</div>
<p>Now we can use the <code>fit()</code> function to fit two log-linear models, one to the growth phase before the peak, and one to the decay phase after the peak. We can plot the fitted values from our models (with confidence limits) on top of the actual observed incidence data for Hubei province.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>hubei_incidence_fit</span> <span class='op'>&lt;-</span> <span class='fu'>incidence</span><span class='fu'>::</span><span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/fit.html'>fit</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span>,
                                      split<span class='op'>=</span><span class='va'>hubei_incidence_peak</span><span class='op'>)</span>

<span class='co'># plot the incidence data and the model fit</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/plot.incidence.html'>add_incidence_fit</a></span><span class='op'>(</span><span class='va'>hubei_incidence_fit</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Observed and modelled incidence of COVID-19 cases"</span>,
       subtitle<span class='op'>=</span><span class='st'>"Hubei province, 2020"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/fit_incidence_object-1.png" width="624" data-distill-preview=1 /></p>
</div>
<p>From the model, we can extract various parameters of interest: the <strong>growth rate prior to the peak was 0.26</strong> (95% CI 0.21 - 0.31), and the <strong>decay rate after the peak was -0.095</strong> (95% CI -0.0695 - -0.121).</p>
<p>These growth and decay rates are equivalent to a <strong>doubling time of 2.7 days</strong> (95% CI 2.2 - 3.3 days), and a <strong>halving time of 7.3 days</strong> (95% CI 5.7 - 10.0 days).</p>
<p>The doubling and halving time estimates are very handy for informing public health intervention policy, which we will discuss in the conclusion.</p>
<h2 id="estimating-the-reproduction-number-from-log-linear-models">Estimating the reproduction number from log-linear models</h2>
<p>We can also use these log-linear models of the epidemic trajectory to estimate the reproduction number in the growth and decay phases of the epidemic. We need to provide a distribution for the <em>serial interval</em> time, which is the time between the onset of a primary case and the time of onset in its secondary cases. We’ll use a mean of 7.5 days and a standard deviation of 3.4 days to parameterise a discrete gamma distribution for the serial interval. See the discussion in next section of <em>serial intervals</em> for justification of these values. Here is a histogram of our calculated distribution of possible values for <span class="math inline">\(R_{0}\)</span> for the growth phase, based on the log-linear model we fitted to the Hubei incidence data:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mu</span> <span class='op'>&lt;-</span> <span class='fl'>7.5</span> <span class='co'># days</span>
<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fl'>3.4</span> <span class='co'># days</span>
<span class='va'>param</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://www.repidemicsconsortium.org/epitrix/reference/gamma_tools.html'>gamma_mucv2shapescale</a></span><span class='op'>(</span><span class='va'>mu</span>, <span class='va'>sigma</span> <span class='op'>/</span> <span class='va'>mu</span><span class='op'>)</span>

<span class='va'>w</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/distcrete/man/distcrete.html'>distcrete</a></span><span class='op'>(</span><span class='st'>"gamma"</span>, interval <span class='op'>=</span> <span class='fl'>1</span>,
                 shape <span class='op'>=</span> <span class='va'>param</span><span class='op'>$</span><span class='va'>shape</span>,
                 scale <span class='op'>=</span> <span class='va'>param</span><span class='op'>$</span><span class='va'>scale</span>, w <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>

<span class='va'>growth_R0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://www.repidemicsconsortium.org/epitrix/reference/r2R0.html'>lm2R0_sample</a></span><span class='op'>(</span><span class='va'>hubei_incidence_fit</span><span class='op'>$</span><span class='va'>before</span><span class='op'>$</span><span class='va'>model</span>, <span class='va'>w</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>growth_R0</span>, col <span class='op'>=</span> <span class='st'>"grey"</span>, border <span class='op'>=</span> <span class='st'>"white"</span>, main <span class='op'>=</span> <span class='st'>"Distribution of R0"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Base_Model_files/figure-html5/est_R0_growth-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>growth_R0</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  3.641   4.150   4.454   4.520   4.785   6.198 </code></pre>
</div>
<p>Note that the central estimates for <span class="math inline">\(R_{0}\)</span> are considerably higher than those we calculated with a SIR model fitted to the same Hubei province data, and are also higher than <span class="math inline">\(R_{0}\)</span> estimates published elsewhere, but they are consistent with estimates of the instantaneous effective reproduction number <span class="math inline">\(R_{e}\)</span> which we calculate in the next section<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>Here is the estimated <span class="math inline">\(R_{e}\)</span> for the decay phase:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>decay_R0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://www.repidemicsconsortium.org/epitrix/reference/r2R0.html'>lm2R0_sample</a></span><span class='op'>(</span><span class='va'>hubei_incidence_fit</span><span class='op'>$</span><span class='va'>after</span><span class='op'>$</span><span class='va'>model</span>, <span class='va'>w</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>decay_R0</span>, col <span class='op'>=</span> <span class='st'>"grey"</span>, border <span class='op'>=</span> <span class='st'>"white"</span>, main <span class='op'>=</span> <span class='st'>"Distribution of R0"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Base_Model_files/figure-html5/est_R0_decay-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>decay_R0</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.3825  0.4389  0.4748  0.4750  0.5111  0.6081 </code></pre>
</div>
<p>It is well below 1.0 – otherwise the epidemic would not be decaying, as we observe.</p>
<h1 id="projections">Projections</h1>
<p>We saw above how we can make fairly naïve and highly alarming projections based on a simple SIR model. But more sophisticated projections are also possible.</p>
<p>Here we’ll examine the use of the <a href="https://www.repidemicsconsortium.org/projections/"><code>projections</code> package</a>, which is also part of the <strong>RECON</strong> suite. From its manual page:</p>
<blockquote>
<p><code>projections</code> uses data on daily incidence, the <em>serial interval</em> (time between onsets of infectors and infectees) and the reproduction number to simulate plausible epidemic trajectories and project future incidence. It relies on a branching process where daily incidence follows a Poisson process determined by a daily infectiousness, computed as:</p>
</blockquote>
<p><span class="math display">\[\lambda_t = \sum_{s=1}^{t-1} y_s w(t-s)\]</span></p>
<blockquote>
<p>where <span class="math inline">\(w()\)</span> is the probability mass function (PMF) of the serial interval, and <span class="math inline">\(y_s\)</span> is the incidence at time <span class="math inline">\(s\)</span>.</p>
</blockquote>
<p>We can just re-use the <code>incidence()</code> object for the Hubei incidence data which we created above for the purposes of fitting log-linear models to the epidemic trajectories. We’ll also use the discrete <em>serial interval</em> distribution we created, and the median <em>reproduction number</em> we calculated above for the growth and decay phases of the outbreak in Hubei province, in order to test the projection of those phases of the epidemic in Hubei forwards. We’ll base these projections on only the first parts of the growth and decay phases, so that we can then compare the resulting projections against the observed incidence data for the balance of thoe phases. If the projections match that observed reality reasonably well, we can then have some confidence in any forward projections into the future which we make. Such projections are obviously valuable for planning purposes – for example, during the decay phase of an epidemic, projections of the decay can be used to inform how long public health interventions such as transport lock-downs and mandatory social isolation may have to be kept in place.</p>
<p>First we’ll project the Hubei province incidence data for the first part of the growth phase of the epidemic. Recall that we found the peak of the epidemic (daily incidence) curve for Hubei to have occured on 04 February 2020. Thus, we’ll base our projection on the Hubei incidence data up to 14 days before that peak, and compare with the observed data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>pred_fwd_days</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>date_range</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/get_dates.html'>get_dates</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>hubei_incidence_peak</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>pred_fwd_days</span><span class='op'>)</span>

<span class='va'>test_pred_growth</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://www.repidemicsconsortium.org/projections/reference/project.html'>project</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>[</span><span class='va'>date_range</span><span class='op'>]</span>,
                            R <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>growth_R0</span><span class='op'>)</span>,
                            si <span class='op'>=</span> <span class='va'>w</span>,
                            n_days <span class='op'>=</span> <span class='va'>pred_fwd_days</span>, n_sim <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span>

<span class='co'># convert the test_pred_growth matrix to a data frame and get the median </span>
<span class='co'># incidence for all the simulations for each date</span>
<span class='va'>test_pred_growth_median_counts</span> <span class='op'>&lt;-</span> <span class='va'>test_pred_growth</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='op'>-</span><span class='va'>dates</span>, 
               names_to<span class='op'>=</span><span class='st'>"simulation"</span>, 
               values_to<span class='op'>=</span><span class='st'>"incidence"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>dates</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarise</span><span class='op'>(</span>incident_cases<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>incidence</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>data_type <span class='op'>=</span> <span class='st'>"projection"</span><span class='op'>)</span>

<span class='va'>test_pred_growth_median_counts</span> <span class='op'>%&gt;%</span>
  <span class='fu'>bind_rows</span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>dates<span class='op'>=</span><span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/get_dates.html'>get_dates</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span>,
                   incident_cases<span class='op'>=</span><span class='fu'><a href='https://www.repidemicsconsortium.org/incidence/reference/get_counts.html'>get_counts</a></span><span class='op'>(</span><span class='va'>hubei_incidence_object</span><span class='op'>)</span>,
                   data_type<span class='op'>=</span><span class='st'>"observed"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>dates</span>, y<span class='op'>=</span><span class='va'>incident_cases</span>, colour<span class='op'>=</span><span class='va'>data_type</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>""</span>, y<span class='op'>=</span><span class='st'>"Daily incident confirmed cases"</span>,
         title<span class='op'>=</span><span class='st'>"Observed versus growth-phase projection of incident cases\nin Hubei province"</span>,
         subtitle<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"(projection based on observed case counts up to"</span>, 
                        <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>hubei_incidence_peak</span> <span class='op'>-</span> <span class='fu'><a href='http://lubridate.tidyverse.org/reference/period.html'>days</a></span><span class='op'>(</span><span class='va'>pred_fwd_days</span><span class='op'>)</span>, <span class='st'>"%d %B %Y"</span><span class='op'>)</span>,
                        <span class='st'>")"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
         <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>legend.position<span class='op'>=</span><span class='st'>"top"</span>, legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Base_Model_files/figure-html5/test_projection_Hubei_growth-1.png" width="624" /></p>
</div>
<p>The projection, based only on observed data up to 25 January 2020, is in remarkably close agreement with the observed data. Let’s do the same for the decay phase, this time holding out 5 days of the observed decay from our prediction.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Base_Model_files/figure-html5/test_projection_Hubei_decay-1.png" width="624" /></p>
</div>
<p>Based on that projection, it will take until the beginning of April for the outbreak in Hubei to be extinguished. But perhaps that is too conservative a prediction.</p>
<h1 id="conclusions">Conclusions</h1>
<h2 id="public-health-considerations">Public health considerations</h2>
<p>It seems likely that China has done a good job against the COVID-19 outbreak, having successfully mitigated the spread of the virus through <strong>very</strong> decisive and prompt public health action, in particular closing Wuhan and other cities in Hubei province, and implementing strict social isolation policies within those cities.</p>
<p>Just how long these measures will need to remain in place depends is unclear, but could be estimated using methods similar to those described above.</p>
<h2 id="data-science-considerations">Data science considerations</h2>
<p>From a data science (and public health) perspective, the main thing to note is that by doing all this data manipulation and model estimation using program code, as we have been doing, rather than using spreadsheets or some other manual process, it is very easy to re-run everything on-demand in just a minute or so, and thus current estimates and projections can readily be automatically updated as new observed data becomes available each day, or even every hour.</p>
<p>The absence of better <em>serial interval</em> data is unfortunate. These data can be sampled – it isn’t necessary to collect these data for everycase, just a representative sample of them.</p>
<p>Similarly better line-listing data, even if only for samples of cases, would facilitate modelling of outbreak control and estimation of how long public health controls need to be kept in place in each jurisdiction.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>It is also possible to fit SIR and related models by MLE.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>They are also consistent with unpublished estimates of <span class="math inline">\(R_{0}\)</span> for the COVID-19 virus being discussed in various expert WHO fora.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
